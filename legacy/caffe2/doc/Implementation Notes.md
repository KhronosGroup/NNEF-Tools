# Implementation Documentation

## General Notes
- Operations of the NNEF format are represented by the Node class, that are used as nodes within a directed NXGraph.
- The Node class is the superclass for all individual primitive operations within the NNEF documentation.
- The NNEFGraph is generated once all nodes are generated by using a node pool or by working backwards from the output nodes to find all dependent nodes.
- The output folder may not use a name that is a required directory for the converter (tensorflow, caffe2, common, etc.).
- The output folder is cleaned before outputs are placed there to allow simple compression, avoid using output folders that have files. Base folder will be 'nnef_output'
- The --compress command only applies for conversions to NNEF.
- Handling operations that contain multiple outputs is handled by generating an additional node that has an op of 'output_val', that connects to the base node (split, max\_pool\_with\_argmax). This allows for the removal of issues with naming and output shapes. They are skipped when generating the .graph file.
- Output shapes are generated for each node allowing for easier exportation of certain operations.
- Reshaping removes the concept of data format within the graph, as post reshape no guarantees can be made about the format (example reshaping NCHW and NHWC to [1,-1] lead to different arrays). 
- Currently all Nodes must be provided with a unique ID.
- shapeof primitive operation does not allow "x =" to be within NNEF graph file, it is removed on saving the file.
- It is not mandatory to specify parameters that have a default, when the primitive Node is created any parameters that are not specified will be have that parameter equal to the default.
- When saving the .graph file any parameters that are the default will not be written, mainly to save space and allow for easier visual parsing. This does not apply to situations where a stride is [1,1] instead of [] despite them being equal in a 2D convolution.

## Caffe2 Importer

- Requires a value_info file in json format to allow the converter to know the initial shapes of externals.
- Handles legacy convolution and pooling parameters for pad, stride, and dilations.

## Caffe2 Exporter

- The output generates three files, two that use the given filename as a base adding 'predict' and 'init' as a prefix and then a value_info.json file.
